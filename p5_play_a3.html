<!doctype html>
<!-- Auteur : David Roche @davR74130 -->
<html lang="fr">
	<head>
		<meta charset="utf-8">
		<title>Créer un jeu avec p5.play</title>
		<link rel="stylesheet" href="css/css/vendor/bootstrap.min.css">
		<link rel="stylesheet" href="css/css/flat-ui.min.css">
		<link rel="stylesheet" href="highlight/styles/tomorrow-night.css">
		<link rel="stylesheet" href="css/style.css">
		<script src="highlight/highlight.pack.js"></script>
		<script>hljs.initHighlightingOnLoad();</script>
    <script src="./css/js/vendor/jquery.min.js"></script>
    <script src="./css/js/flat-ui.min.js"></script>
		<script>
			  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

			  ga('create', 'UA-92673245-1', 'auto');
			  ga('send', 'pageview');
			</script>
		<script>
			  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

			  ga('create', 'UA-92673245-1', 'auto');
			  ga('send', 'pageview');
			</script>
	</head>
	<body>
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <span class="navbar-brand">Créer un jeu avec p5.play</span>
					<span class="navbar-brand">Activité 3</span>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Activités <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
              	<li><a href="./p5_play_a1.html">Activité 1</a></li>
	            <li><a href="./p5_play_a2.html">Activité 2</a></li>
	            <li><a href="./p5_play_a4.html">Activité 4</a></li>
					<li><a href="./p5_play_a5.html">Activité 5</a></li>
	            <li><a href="./p5_play_a6.html">Activité 6</a></li>
	            <li><a href="./p5_play_a7.html">Activité 7</a></li>
              </ul>
            </li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
          	<li><a href="./p5_play_a2.html"><span class="fui-triangle-left-large"></a></li>
            <li><a href="./p5_play_a4.html"><span class="fui-triangle-right-large"></a></li>

          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
    <div class="container act">
    		<p>
				P5.play propose une gestion des collisions et des "rebonds" simple et efficace.
			</p>
			<h4>À faire vous même 3.1</h4>
			<p>
				Saisissez le code suivant dans le fichier script.js et testez cet exemple
			</p>
			<pre><code class="javascript">
var img;
var smiley_sprite_1;
var smiley_sprite_2;
function preload() {
	img=loadImage("asset/smiley.png");
}

function setup() {
    createCanvas(800,300);
    smiley_sprite_1=createSprite(100,150);
    smiley_sprite_1.addImage(img);
    smiley_sprite_1.setVelocity(3,0);
    smiley_sprite_2=createSprite(600,150);
    smiley_sprite_2.addImage(img);
}

function draw() {
	background(240,240,240);
	smiley_sprite_1.bounce(smiley_sprite_2);
	drawSprites();
}
			</code></pre>
			<hr>
			<p>
				Analysons le code ci-dessus :
			</p>
			<p>Nous avons deux sprites : </p>
            <ul>
                <li><i>smiley_sprite_2</i> est, à l'origine, immobile.</li>
                <li><i>smiley_sprite_1</i> "fonce" vers <i>smiley_sprite_2</i></li>
            </ul>
            <p>La méthode <i>bounce</i> permet de gérer les collisions (et les rebonds éventuels) entre les sprites.</p>
            <p>Dans la fonction <i>draw</i> nous avons ajouté la ligne <i>smiley_sprite_1.bounce(smiley_sprite_2)</i> qui permet de gérer la collision entre <i>smiley_sprite_1</i> et <i>smiley_sprite_2</i></p>
            <p>Si vous lancez une balle de ping-pong sur une boule de pétanque, au moment de la collision la boule de pétanque ne bougera (quasiment) pas alors que la balle de ping-pong repartira dans l'autre sens.</p>
            <p>p5.play permet de gérer ce genre de situation en attribuant des "masses" aux sprites.</p>
			<h4>À faire vous même 3.2</h4>
            <p>
				Saisissez le code suivant dans le fichier script.js et testez cet exemple
			</p>
			<pre><code class="javascript">
var img;
var smiley_sprite_1;
var smiley_sprite_2;
function preload() {
	img=loadImage("asset/smiley.png");
}

function setup() {
    createCanvas(800,300);
    smiley_sprite_1=createSprite(100,150);
    smiley_sprite_1.addImage(img);
    smiley_sprite_1.setVelocity(3,0);
    smiley_sprite_1.mass=1;
    smiley_sprite_2=createSprite(600,150);
    smiley_sprite_2.addImage(img);
    smiley_sprite_2.mass=15;
}

function draw() {
	background(240,240,240);
	smiley_sprite_1.bounce(smiley_sprite_2);
	drawSprites();
}
			</code></pre>
			<hr>
			<p>Par défaut la masse d'un sprite est égale à 1 (la ligne <i>smiley_sprite_1.mass=1;</i> ne sert donc à rien).</p>
			<h4>À faire vous même 3.3</h4>
			<p>En repartant de l'exemple précédent, augmentez suffisamment la masse de <i>smiley_sprite_2</i> pour avoir l'effet "balle de ping pong contre boule de pétanque".</p>
			<hr>
			<p>Il est possible de rendre un sprite "insensible" à la collision (comme s'il avait une masse très élevée) grâce à l'attribut <i>immovable</i>.</p>
            <p>Un <i>smiley_sprite_2.immovable=true;</i> rendra <i>smiley_sprite_2</i> "indéplaçable" en cas de collision (quelle que soit sa masse).</p>
            <h4>À faire vous même 3.4</h4>
            <p>
				Saisissez le code suivant dans le fichier script.js et testez cet exemple
			</p>
			<pre><code class="javascript">
var img;
var smiley_sprite_1;
var smiley_sprite_2;
function preload() {
	img=loadImage("asset/smiley.png");
}

function setup() {
    createCanvas(800,300);
    smiley_sprite_1=createSprite(100,150);
    smiley_sprite_1.addImage(img);
    smiley_sprite_1.setVelocity(3,0);
    smiley_sprite_1.mass=1;
    smiley_sprite_2=createSprite(600,150);
    smiley_sprite_2.addImage(img);
    smiley_sprite_2.immovable=true;
}

function draw() {
	background(240,240,240);
	smiley_sprite_1.bounce(smiley_sprite_2);
	drawSprites();
}
			</code></pre>
			<hr>
			<h4>À faire vous même 3.5</h4>
			<p>En utilisant l'image que vous trouverez <a href="asset/wall.png" target="_blank">ici</a>, écrivez un programme permettant d'obtenir ceci :</p>
			<iframe src="p5_play/a3_5/index.html" width="830px" height="380px"></iframe>
            <hr>
            <p>La méthode <i>bounce</i> peut prendre un second paramètre : une fonction de "callback". Cette fonction de "callback" sera exécutée uniquement en cas de collision.</p>
            <h4>À faire vous même 3.6</h4>
            <p>
				Saisissez le code suivant dans le fichier script.js et testez cet exemple
			</p>
			<pre><code class="javascript">
var img;
var smiley_sprite_1;
var smiley_sprite_2;
var cont=false;
function preload() {
	img=loadImage("asset/smiley.png");
}

function setup() {
    createCanvas(800,300);
    smiley_sprite_1=createSprite(100,150);
    smiley_sprite_1.addImage(img);
    smiley_sprite_1.setVelocity(3,0);
    smiley_sprite_1.mass=1;
    smiley_sprite_2=createSprite(600,150);
    smiley_sprite_2.addImage(img);
    smiley_sprite_2.immovable=true;
}

function draw() {
	background(240,240,240);
	smiley_sprite_1.bounce(smiley_sprite_2,contact);
	if (cont==true){
		text("il y a eu contact !",350,100)
	}
	drawSprites();
}
function contact(){
	cont=true;

}
			</code></pre>
			<hr>
            <p>Ci-dessus la fonction <i>contact</i> sera exécutée uniquement s'il y a un contact entre <i>smiley_sprite_1</i> et <i>smiley_sprite_2</i>. Si nécessaire, n'hésitez pas à consulter l'activité p5.js consacrée à l'affichage d'un texte (<a href="p5_base_a9.html" target="_blank">activité 9 p5.js</a>). Si vous avez du mal à comprendre le fonctionnement de ce programme, n'hésitez pas à poser des questions.</p>
            <h4>À faire vous même 3.7</h4>
            <p>Sachant que la méthode <i>remove</i> appliquée à un sprite supprime ce sprite (<i>smiley_sprite_1.remove()</i> supprime le sprite <i>smiley_sprite_1</i>), en repartant de ce qui a été fait ci-dessus, écrivez un programme qui permettra d'obtenir ceci :</p>
            <iframe src="p5_play/a3_7/index.html" width="830px" height="330px"></iframe>
            <hr>
            <p>Il est aussi possible de gérer les collisions sans pour autant gérer les rebonds en utilisant la méthode <i>overlap</i> à la place de la méthode <i>bound</i></p>
            <h4>À faire vous même 3.8</h4>
            <p>
				Saisissez le code suivant dans le fichier script.js et testez cet exemple
			</p>
			<pre><code class="javascript">
var img;
var smiley_sprite_1;
var smiley_sprite_2;
function preload() {
	img=loadImage("asset/smiley.png");
}

function setup() {
    createCanvas(800,300);
    smiley_sprite_1=createSprite(100,150);
    smiley_sprite_1.addImage(img);
    smiley_sprite_1.setVelocity(3,0);
    smiley_sprite_1.mass=1;
    smiley_sprite_2=createSprite(600,150);
    smiley_sprite_2.addImage(img);
    smiley_sprite_2.immovable=true;
}

function draw() {
	background(240,240,240);
	smiley_sprite_1.overlap(smiley_sprite_2,contact);
	drawSprites();
}
function contact(){
	smiley_sprite_2.remove();

}
			</code></pre>
			<hr>
            <h4>À faire vous même 3.9</h4>
            <p>En repartant de l'exemple vu dans le "À faire vous même 3.5", écrivez un code permettant d'obtenir ceci :</p>
            <iframe src="p5_play/a3_9/index.html" width="830px" height="380px"></iframe>
            <p>Le mur droit disparait après 3 rebonds. L'attribut <i>removed</i> permet de savoir si un sprite existe encore : <i>smiley_sprite_1.removed</i> est <i>true</i> si le sprite <i>smiley_sprite_1</i> n'existe pas (ou plus).</p>
            <hr>
            <p>Il est possible de faire rebondir un sprite sur les bords de la fenêtre de jeu en utilisant des sprites. Inutile d'associer une image à ces sprites car ils seront placés en dehors de la fenêtre de jeu, en revanche, il sera nécessaire de préciser la taille des ces sprites en ajoutant deux arguments à la méthode <i>createSprite</i> (quand on associe une image au sprite, c'est la taille de l'image qui définie la taille du sprite). La méthode <i>createSprite</i> s'écrira <i>createSprite(positionX, positionY, tailleX, taille Y)</i></p>
            <h4>À faire vous même 3.10</h4>
            <p>
				Saisissez le code suivant dans le fichier script.js et testez cet exemple
			</p>
			<pre><code class="javascript">
var img;
var smiley_sprite;
function preload() {
    img=loadImage("asset/smiley.png")
}

function setup() {
    createCanvas(800,300);
    smiley_sprite=createSprite(random(20,780),random(20,280));
    smiley_sprite.addImage(img);
    smiley_sprite.setVelocity(random(-5,5),random(-5,5));
    wall_g=createSprite(-5,150,10,300);
    wall_d=createSprite(805,150,10,300);
    wall_h=createSprite(400,-5,800,10);
    wall_b=createSprite(400,305,800,10);
    wall_d.immovable=true;
    wall_g.immovable=true;
    wall_h.immovable=true;
    wall_b.immovable=true;
}
function draw() {
    background(240,240,240);
    smiley_sprite.bounce(wall_g);
    smiley_sprite.bounce(wall_d);
    smiley_sprite.bounce(wall_b);
    smiley_sprite.bounce(wall_h);
    drawSprites();
}
			</code></pre>
    </div>
	</body>
</html>
