<!doctype html>
<!-- Auteur : David Roche @davR74130 -->
<html lang="fr">
	<head>
		<meta charset="utf-8">
		<title>Créer un jeu avec p5.play</title>
		<link rel="stylesheet" href="css/css/vendor/bootstrap.min.css">
		<link rel="stylesheet" href="css/css/flat-ui.min.css">
		<link rel="stylesheet" href="highlight/styles/tomorrow-night.css">
		<link rel="stylesheet" href="css/style.css">
		<script src="highlight/highlight.pack.js"></script>
		<script>hljs.initHighlightingOnLoad();</script>
    <script src="./css/js/vendor/jquery.min.js"></script>
    <script src="./css/js/flat-ui.min.js"></script>
		<script>
			  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
			  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
			  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
			  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

			  ga('create', 'UA-92673245-1', 'auto');
			  ga('send', 'pageview');
			</script>
	</head>
	<body>
    <nav class="navbar navbar-default navbar-fixed-top">
      <div class="container">
        <div class="navbar-header">
          <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
            <span class="sr-only">Toggle navigation</span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button>
          <span class="navbar-brand">Créer un jeu avec p5.play</span>
					<span class="navbar-brand">Activité 6</span>
        </div>
        <div id="navbar" class="navbar-collapse collapse">
          <ul class="nav navbar-nav">
            <li class="dropdown">
              <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">Activités <span class="caret"></span></a>
              <ul class="dropdown-menu" role="menu">
              	<li><a href="./p5_play_a1.html">Activité 1</a></li>
	            <li><a href="./p5_play_a2.html">Activité 2</a></li>
	            <li><a href="./p5_play_a3.html">Activité 3</a></li>
				<li><a href="./p5_play_a4.html">Activité 4</a></li>
	            <li><a href="./p5_play_a5.html">Activité 5</a></li>
	            <li><a href="./p5_play_a7.html">Activité 7</a></li>
              </ul>
            </li>
          </ul>
          <ul class="nav navbar-nav navbar-right">
          	<li><a href="./p5_play_a5.html"><span class="fui-triangle-left-large"></a></li>
            <li><a href="./p5_play_a7.html"><span class="fui-triangle-right-large"></a></li>

          </ul>
        </div><!--/.nav-collapse -->
      </div>
    </nav>
    <div class="container act">
			<p>
				Dans cette dernière activité, nous allons travailler sur l'animation des sprites. Pour suivre cette activité, il est nécessaire de télécharger l'archive suivante : <a href="asset/anim_play.zip" target="_blank">anim_play.zip</a>. Une fois cette archive téléchargée, placez les images contenues dans cette archive dans le dossier "asset".
			</p>
            <p>L'animation d'un sprite est basée sur le principe du dessin animé : le "défilement" d'une série d'images fixes donne l'illusion du mouvement.</p>
            <p>Avant de pouvoir animer un sprite, il faudra créer une animation. Il existe plusieurs méthodes permettant de créer une animation, nous allons en étudier 2.</p>
			<h4>À faire vous même 6.1</h4>
            <p>
				Saisissez le code suivant dans le fichier script.js et testez cet exemple
			</p>
			<pre><code class="javascript">
var perso;
var perso_walk;
function preload() {
	perso_walk = loadAnimation("asset/ghost_walk0001.png", "asset/ghost_walk0002.png",
	"asset/ghost_walk0003.png", "asset/ghost_walk0004.png");
}
function setup() {
	createCanvas(800,300);
	perso=createSprite(400,150);
	perso.addAnimation("walk",perso_walk);
	perso.changeAnimation("walk");

}
function draw() {
	background(240,240,240);
	drawSprites();
}
			</code></pre>
			<hr>
            <p>Analysons le code ci-dessus :</p>
			<p>La méthode <i>loadAnimation</i> permet de créer une animation (nous "stockons" cette animation dans la variable <i>perso_walk</i>). La méthode <i>loadAnimation</i> prend en paramètres les différentes images qui composent l'animation : <i>perso_walk = loadAnimation("asset/ghost_walk0001.png", "asset/ghost_walk0002.png","asset/ghost_walk0003.png", "asset/ghost_walk0004.png");</i></p>
            <p>Une fois l'animation créée, il faut l'associer à un sprite en utilisant la méthode <i>addAnimation</i> : <i>perso.addAnimation("walk",perso_walk);</i>. Cette méthode prend en paramètres le nom de l'animation (<i>walk</i>) et l'animation elle-même (<i>perso_walk</i>).</p>
            <p>La méthode <i>changeAnimation</i> permet de "jouer" l'animation, elle prend en paramètre le nom de l'animation à jouer : <i>perso.changeAnimation("walk")</i></p>
            <p>Il est possible d'associer plusieurs animations à un sprite :</p>
            <h4>À faire vous même 6.2</h4>
            <p>
				Saisissez le code suivant dans le fichier script.js et testez cet exemple
			</p>
            <pre><code class="javascript">
var perso;
var perso_walk;
function preload() {
	perso_walk = loadAnimation("asset/ghost_walk0001.png", "asset/ghost_walk0002.png",
	"asset/ghost_walk0003.png", "asset/ghost_walk0004.png");
	perso_wait = loadAnimation("asset/ghost_standing0001.png","asset/ghost_standing0002.png","asset/ghost_standing0003.png","asset/ghost_standing0004.png","asset/ghost_standing0005.png","asset/ghost_standing0006.png");
}
function setup() {
	createCanvas(800,300);
	perso=createSprite(400,150);
	perso.addAnimation("walk",perso_walk);
	perso.addAnimation("wait",perso_wait);
	perso.changeAnimation("wait");

}
function draw() {
	background(240,240,240);
	drawSprites();
}
function keyPressed(){
   if (keyCode==37){
   	perso.mirrorX(-1);
   	perso.changeAnimation("walk");
  }
  else if (keyCode==39){
  	perso.mirrorX(1);
  	perso.changeAnimation("walk");
  }
  else {
  	perso.changeAnimation("wait");
  }

}
function keyReleased(){
	perso.changeAnimation("wait");
}
			</code></pre>
            <hr>
            <p>
				Seule nouveauté dans l'exemple ci-dessus : l'utilisation de la méthode <i>mirrorX</i> (<i>perso.mirrorX(-1)</i> et <i>perso.mirrorX(1)</i>). Comme vous l'avez sans doute remarqué, dans le dossier "asset", nous n'avons pas d'image du personnage "regardant" vers la gauche. Pourtant, en appuyant sur la flèche gauche du clavier, nous avons bien une animation du personnage vers la gauche.
			</p>
            <p>Ceci est possible grâce à la méthode <i>mirrorX</i> qui permet d'avoir "l'animation symétrique" (<i>perso.mirrorX(-1)</i> permet d'avoir "l'animation symétrique", <i>perso.mirrorX(1)</i> permet de retrouver l'animation dans le "bon sens".</p>
            <p>P5.play propose aussi, pour créer des animations, d'utiliser des spritesheets (les images nécessaires à l'animation sont regroupées dans un unique fichier)</p>
            <p>Exemple de spritesheet :</p>
            <img src="asset/sonic_1.png" alt="sonic">
						<p><strong>ATTENTION : visiblement, les exemples ci-dessous (6.3 et 6.4) ne fonctionnent pas avec les dernières versions de p5js. Vous devez donc utiliser une ancienne version de p5js à télécharger <a href="p5_play/p5.min.js">ici</a> (clic de souris droit puis "Enregistrer sous") pour travailler sur les deux exemples suivants. N'oubliez pas, si nécessaire, de modifier le fichier index.html."</strong></p>
            <h4>À faire vous même 6.3</h4>
            <p>
				Saisissez le code suivant dans le fichier script.js et testez cet exemple
			</p>
			<pre><code class="javascript">
var perso;
var perso_walk;
function preload() {
	perso_sprite_sheet_walk = loadSpriteSheet('asset/sonic_1.png', 48, 48, 6);
}
function setup() {
	createCanvas(800,300);
	perso=createSprite(400,150);
	perso_walk=loadAnimation(perso_sprite_sheet_walk);
	perso_walk.frameDelay=4;
	perso.addAnimation("walk",perso_walk);
	perso.changeAnimation("walk");
}
function draw() {
	background(240,240,240);
	drawSprites();
}
			</code></pre>
			<hr>
            <p>
				Analysons le code ci-dessus :
			</p>
            <p>La méthode <i>loadSpriteSheet</i> (<i>perso_sprite_sheet_walk = loadSpriteSheet('asset/sonic_1.png', 48, 48, 6)</i>) va nous permettre d'utiliser un spritesheet pour créer notre animation. Cette méthode prend 4 paramètres : le chemin vers l'image qui servira de spritesheet, la largeur du sprite, la hauteur du sprite et le nombre d'images utilisé.</p>
            <p>La méthode <i>loadAnimation</i> prend en paramètre le nom du spritesheet (<i>loadAnimation(perso_sprite_sheet_walk)</i>).</p>
            <p><i>frameDelay</i> (<i>perso_walk.frameDelay=4</i>) permet de modifier la vitesse de l'animation : plus la valeur est petite, plus l'animation est rapide (les différentes images défilent plus rapidement). Par défaut, <i>frameDelay</i> a pour valeur 2.</p>
            <h4>À faire vous même 6.4</h4>
            <p>Écrivez un programme permettant d'obtenir ceci (utilisez les flèches droite et gauche du clavier) :</p>
			<iframe src="p5_play/a6_4/index.html" width="830px" height="330px"></iframe>
            <hr>
    </div>
	</body>
</html>
